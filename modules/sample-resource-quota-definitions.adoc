// Module included in the following assemblies:
//
// ../scalability_and_performance/compute-resource-quotas.adoc

:_mod-docs-content-type: CONCEPT
[id="sample-resource-quota-definitions_{context}"]
= Sample resource quota definitions

[role="_abstract"]
To properly structure your quota configurations, reference these sample `ResourceQuota` definitions. These YAML examples demonstrate how to specify hard limits for compute resources, storage, and object counts to ensure your project complies with cluster policies.

.Example core-object-counts.yaml
[source,yaml]
----
apiVersion: v1
kind: ResourceQuota
metadata:
  name: core-object-counts
spec:
  hard:
    configmaps: "10"
    persistentvolumeclaims: "4"
    replicationcontrollers: "20"
    secrets: "10"
    services: "10"
# ...
----

where:

`configmaps`:: Specifies the total number of `ConfigMap` objects that can exist in the project.

`persistentvolumeclaims`:: Specifies the total number of persistent volume claims (PVCs) that can exist in the project.

`replicationcontrollers`:: Specifies the total number of replication controllers that can exist in the project.

`secrets`:: Specifies the total number of secrets that can exist in the project.

`services`:: Specifies the total number of services that can exist in the project.

.Example openshift-object-counts.yaml
[source,yaml]
----
apiVersion: v1
kind: ResourceQuota
metadata:
  name: openshift-object-counts
spec:
  hard:
    openshift.io/imagestreams: "10"
# ...
----

where:

`openshift.io/imagestreams`:: Specifies the total number of image streams that can exist in the project.

.Example compute-resources.yaml
[source,yaml]
----
apiVersion: v1
kind: ResourceQuota
metadata:
  name: compute-resources
spec:
  hard:
    pods: "4"
    requests.cpu: "1"
    requests.memory: 1Gi
    requests.ephemeral-storage: 2Gi
    limits.cpu: "2"
    limits.memory: 2Gi
    limits.ephemeral-storage: 4Gi
# ...
----

where:

`pods`:: Specifies the total number of pods in a non-terminal state that can exist in the project.

`requests.cpu`:: Specifies that across all pods in a non-terminal state, the sum of CPU requests cannot exceed 1 core.

`requests.memory`:: Specifies that across all pods in a non-terminal state, the sum of memory requests cannot exceed 1 Gi.

`requests.ephemeral-storage`:: Specifies that across all pods in a non-terminal state, the sum of ephemeral storage requests cannot exceed 2 Gi.

`limits.cpu`:: Specifies that across all pods in a non-terminal state, the sum of CPU limits cannot exceed 2 cores.

`limits.memory`:: Specifies that across all pods in a non-terminal state, the sum of memory limits cannot exceed 2 Gi.

`limits.ephemeral-storage`:: Specifies that across all pods in a non-terminal state, the sum of ephemeral storage limits cannot exceed 4 Gi.


.Example besteffort.yaml
[source,yaml]
----
apiVersion: v1
kind: ResourceQuota
metadata:
  name: besteffort
spec:
  hard:
    pods: "1"
  scopes:
  - BestEffort
# ...
----

where:

`pods`:: Specifies the total number of pods in a non-terminal state with `BestEffort` quality of service that can exist in the project.

`scopes`:: Specifies a restriction on the quota to only match pods that have `BestEffort` quality of service for either memory or CPU.

.Example compute-resources-long-running.yaml
[source,yaml]
----
apiVersion: v1
kind: ResourceQuota
metadata:
  name: compute-resources-long-running
spec:
  hard:
    pods: "4"
    limits.cpu: "4"
    limits.memory: "2Gi"
    limits.ephemeral-storage: "4Gi"
  scopes:
  - NotTerminating
# ...
----

where:

`pods`:: Specifies the total number of pods in a non-terminal state.

`limits.cpu`:: Specifies that across all pods in a non-terminal state, the sum of CPU limits cannot exceed this value.

`limits.memory`:: Specifies that across all pods in a non-terminal state, the sum of memory limits cannot exceed this value.

`limits.ephemeral-storage`:: Specifies that across all pods in a non-terminal state, the sum of ephemeral storage limits cannot exceed this value.

`scopes`:: Specifies a restriction on the quota that only matches pods where `spec.activeDeadlineSeconds` is set to `nil`. Build pods fall under `NotTerminating` unless the `RestartNever` policy is applied.


.Example compute-resources-time-bound.yaml
[source,yaml]
----
apiVersion: v1
kind: ResourceQuota
metadata:
  name: compute-resources-time-bound
spec:
  hard:
    pods: "2"
    limits.cpu: "1"
    limits.memory: "1Gi"
    limits.ephemeral-storage: "1Gi"
  scopes:
  - Terminating
# ...
----

where:

`pods`:: Specifies the total number of pods in a non-terminal state.

`limits.cpu`:: Specifies that across all pods in a non-terminal state, the sum of CPU limits cannot exceed this value.

`limits.memory`:: Specifies that across all pods in a non-terminal state, the sum of memory limits cannot exceed this value.

`limits.ephemeral-storage`:: Specifies that across all pods in a non-terminal state, the sum of ephemeral storage limits cannot exceed this value.

`scopes`:: Specifies a restriction on the quota that only matches pods where `spec.activeDeadlineSeconds>=0`. For example, this quota would charge for build pods, but not long running pods such as a web server or database.

.Example storage-consumption.yaml
[source,yaml]
----
apiVersion: v1
kind: ResourceQuota
metadata:
  name: storage-consumption
spec:
  hard:
    persistentvolumeclaims: "10"
    requests.storage: "50Gi"
    gold.storageclass.storage.k8s.io/requests.storage: "10Gi"
    silver.storageclass.storage.k8s.io/requests.storage: "20Gi"
    silver.storageclass.storage.k8s.io/persistentvolumeclaims: "5"
    bronze.storageclass.storage.k8s.io/requests.storage: "0"
    bronze.storageclass.storage.k8s.io/persistentvolumeclaims: "0"
# ...
----

where:

`persistentvolumeclaims`:: Specifies the total number of PVCs in a project.

`requests.storage`:: Specifies that across all PVCs in a project, the sum of storage requested cannot exceed this value.

`gold.storageclass.storage.k8s.io/requests.storage`:: Specifies that across all PVCs in a project, the sum of storage requested in the gold storage class cannot exceed this value.

`silver.storageclass.storage.k8s.io/requests.storage`:: Specifies that across all PVCs in a project, the sum of storage requested in the silver storage class cannot exceed this value.

`silver.storageclass.storage.k8s.io/persistentvolumeclaims`:: Specifies that across PVCs in a project, the total number of claims in the silver storage class cannot exceed this value.

`bronze.storageclass.storage.k8s.io/requests.storage`:: Specifies that across all PVCs in a project, the sum of storage requested in the bronze storage class cannot exceed this value. When this is set to `0`, the bronze storage class cannot request storage.

`bronze.storageclass.storage.k8s.io/persistentvolumeclaims`:: Specifies that across all PVCs in a project, the sum of storage requested in the bronze storage class cannot exceed this value. When this is set to `0`, the bronze storage class cannot create claims.

