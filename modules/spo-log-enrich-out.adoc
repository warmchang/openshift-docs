// Module included in the following assemblies:
//
// * security/security_profiles_operator/spo-logging.adoc

:_mod-docs-content-type: REFERENCE
[id="spo-log-enrich-out_{context}"]
= Audit JSON Log Enricher Output

[role="_abstract"]
The Audit JSON Log Enricher captures two entries for this exec session, the SPO-EXEC_REQUEST_UID injection and the command run on the pod. They are connected by looking for the common `UID` value.

. The first listing is the container runtime wrapper.
+
[source,yaml]
----
{
  "auditID": "062e2bd2-xxxx-xxxx-xxxx-57fb39d65a99",
  "cmdLine": "env SPO_EXEC_REQUEST_UID=aec3e0e1-xxxx-xxxx-xxxx-a7c58241f1a9 sh -c touch /tmp/testfile.txt ",
  "executable": "/usr/bin/crun",
  "pid": 144966,
  "requestUID": "aec3e0e1-xxxx-xxxx-xxxx-a7c58241f1a9",
  "resource": {
    "container": "nginx",
    "namespace": "default",
    "pod": "my-pod"
  },
  "node": {
    "name": "worker-1"
  },
  "syscalls": ["execve", "getpid", "clone"],
  "timestamp": "2026-02-16T14:01:07.000Z"
}
----
+
. The second listing is the actual command executed.
+
[source,yaml]
----
{
  "auditID": "d586679d-xxxx-xxxx-xxxx-9dc8ab273065",
  "cmdLine": "touch /tmp/testfile.txt ",
  "executable": "/bin/dash",
  "pid": 144968,
  "requestUID": "aec3e0e1-xxxx-xxxx-xxxx-a7c58241f1a9", // Correlation key
  "resource": {
    "container": "nginx",
    "namespace": "default",
    "pod": "my-pod"
  },
  "node": {
    "name": "worker-1"
  },
  "syscalls": ["execve"],
  "timestamp": "2026-02-16T14:01:07.000Z"
}
----
+
. You can search the Kubernetes API audit log by using the `requestUID` with the following command:
+
[source,terminal]
----
$ oc adm node-logs --role=master --path=kube-apiserver/audit.log | grep request_UID
----
