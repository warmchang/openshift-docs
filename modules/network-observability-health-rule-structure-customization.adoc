// Module included in the following assemblies:
//
// network_observability/network-observability-alerts.adoc

:_mod-docs-content-type: CONCEPT
[id="network-observability-health-rule-structure-customization_{context}"]
= Network observability health rule structure and customization

[role="_abstract"]
Health rules in the Network Observability Operator are defined using rule templates and variants in the `spec.processor.metrics.healthRules` object of the `FlowCollector` custom resource (CR). You can customize the default templates and variants for flexible, fine-grained alerting.

For each template, you can define a list of variants, each with their own thresholds and grouping configurations. For more information, see the "List of default alert templates".

Here is an example:

[source,yaml]
----
apiVersion: flows.netobserv.io/v1beta1
kind: FlowCollector
metadata:
  name: flow-collector
spec:
  processor:
    metrics:
      healthRules:
      - template: PacketDropsByKernel
        mode: Alert # or Recording
        variants:
        # triggered when the whole cluster traffic (no grouping) reaches 10% of drops
        - thresholds:
            critical: "10"
        # triggered when per-node traffic reaches 5% of drops, with gradual severity
        - thresholds:
            critical: "15"
            warning: "10"
            info: "5"
          groupBy: Node
----

where:

`spec.processor.metrics.healthRules.template`:: Specifies the name of the predefined rule template.
`spec.processor.metrics.healthRules.mode`:: Specifies whether the rule functions as an `Alert` or a `Recording` rule. This setting can either be defined per variant, or for the whole template.
`spec.processor.metrics.healthRules.variants.thresholds`:: Specifies the numerical values that trigger the rule. You can define multiple severity levels, such as `critical`, `warning`, or `info`, within a single variant.
`cluster-wide variant`:: Specifies a variant defined without a `groupBy` setting. In the provided example, this variant triggers when the total cluster traffic reaches 10% drops.
`spec.processor.metrics.healthRules.variants.groupBy`:: Specifies the dimension used to aggregate the metric. In the provided example, the alert is evaluated independently for each *Node8.

[NOTE]
====
Customizing a rule replaces the default configuration for that template. If you want to keep the default configurations, you must manually replicate them.
====